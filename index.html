<!DOCTYPE html>
<html lang='en'>
<head>
<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>Podcast Lesson Template</title>
<style>
/* --- CORE DESIGN SYSTEM --- */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    background: #ffffff;
    min-height: 100vh;
    color: #2d3748;
    line-height: 1.6;
}

.lesson-container {
    max-width: 800px;
    margin: 0 auto;
    padding: 40px 20px;
    text-align: center;
}

/* Typography */
h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 0.5rem;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    line-height: 1.2;
}

h3 {
    font-size: 1.25rem;
    font-weight: 500;
    color: #718096;
    margin-bottom: 2rem;
}

p {
    font-size: 1.125rem;
    line-height: 1.7;
    color: #4a5568;
    margin-bottom: 1.5rem;
    text-align: center; /* Centered for podcast descriptions */
}

/* Images */
.podcast-hero-image {
    width: 100%;
    max-width: 400px;
    height: auto;
    border-radius: 12px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    margin: 0 auto 30px auto;
    display: block;
    transition: transform 0.3s ease;
    background: #f1f5f9; /* Placeholder bg */
}

.podcast-hero-image:hover {
    transform: scale(1.02);
}

/* Audio Player Container */
.audio-card {
    background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
    border: 1px solid #e2e8f0;
    border-radius: 16px;
    padding: 30px;
    margin: 2rem 0;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.1);
    position: relative;
    overflow: hidden;
}

.audio-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 4px;
    background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
}

audio {
    width: 100%;
    height: 50px;
    outline: none;
    margin-top: 10px;
    border-radius: 25px;
}

/* Customizing audio player colors for webkit browsers */
audio::-webkit-media-controls-panel {
    background-color: #f1f5f9;
}

/* Mark Completed Button */
.mark-completed-button {
    display: block;
    width: 100%;
    max-width: 300px;
    margin: 40px auto;
    padding: 16px 32px;
    background: linear-gradient(135deg, #48bb78 0%, #38a169 100%);
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 20px rgba(72, 187, 120, 0.3);
    text-decoration: none;
}

.mark-completed-button:hover {
    transform: translateY(-3px);
    box-shadow: 0 10px 25px rgba(72, 187, 120, 0.4);
}

.mark-completed-button.completed {
    background: linear-gradient(135deg, #94a3b8 0%, #64748b 100%);
    cursor: default;
    transform: none;
}

/* Success Animation */
.success-message {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
    padding: 20px 30px;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 600;
    box-shadow: 0 10px 25px rgba(40, 167, 69, 0.3);
    z-index: 10000;
    opacity: 0;
    animation: success-popup 2.5s ease-out;
    pointer-events: none;
}
@keyframes success-popup {
    0% { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
    20% { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }
    40% { transform: translate(-50%, -50%) scale(1); }
    80% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
    100% { opacity: 0; transform: translate(-50%, -50%) scale(0.9); }
}
.confetti-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; overflow: hidden; }
.confetti { position: absolute; font-size: 20px; animation: confetti-fall 3s linear infinite; }
@keyframes confetti-fall { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }

/* Responsive */
@media (max-width: 768px) {
    .lesson-container { padding: 20px 15px; }
    h1 { font-size: 2rem; }
}
</style>
</head>
<body>

<div class="lesson-container">
    
    <!-- [EDIT 1] HERO IMAGE: Change src to your image path -->
    <img src="images/podcast_placeholder.jpg" 
         alt="Podcast Cover" 
         class="podcast-hero-image" 
         onerror="this.src='https://placehold.co/400x400/764ba2/ffffff?text=Podcast+Cover';">

    <!-- [EDIT 2] TITLES -->
    <h1>Podcast Title Here</h1>
    <h3>Episode Subtitle / Number</h3>

    <!-- [EDIT 3] DESCRIPTION (Optional) -->
    <p>A brief one-sentence description of what the user is about to listen to.</p>

    <!-- AUDIO PLAYER -->
    <div class="audio-card">
        <p style="text-align: center; margin-bottom: 15px; font-weight: 600; color: #667eea;">Listen to the Lesson</p>
        
        <!-- [EDIT 4] AUDIO SOURCE: Change src to your .wav or .mp3 file -->
        <audio controls preload="auto">
            <source src="audio/your_audio_file.wav" type="audio/wav">
            Your browser does not support the audio element.
        </audio>
    </div>

    <!-- COMPLETION BUTTON -->
    <button id="markCompletedBtn" class="mark-completed-button" onclick="toggleCompleted()">âœ“ Mark as Completed</button>

</div>

<script>
// --- Completion Logic ---

function toggleCompleted() {
    const button = document.getElementById('markCompletedBtn');
    if (!button) return;
    const isCompleted = button.classList.contains('completed');
    
    if (!isCompleted) {
        // [EDIT 5] LESSON IDs: Update these for LMS tracking
        try {
            if (window.parent && window.parent.ProgressTracker) {
                let courseId = 'computer-vision';
                let pathId = 'generative-adversarial-networks';
                let moduleId = 'module-id';
                let lessonId = 'unique-lesson-id'; // <--- IMPORTANT: Change this for each new podcast page
                
                // Route override check
                if (window.parent.currentRoute) {
                    const route = window.parent.currentRoute;
                    if (route.courseId) courseId = route.courseId;
                    if (route.pathId) pathId = route.pathId;
                    if (route.moduleId) moduleId = route.moduleId;
                    if (route.lessonId) lessonId = route.lessonId;
                }
                
                window.parent.ProgressTracker.markLessonCompleted(courseId, pathId, moduleId, lessonId);
            }
        } catch (error) {
            console.error('Error with ProgressTracker:', error);
        }

        button.classList.add('completed');
        button.innerHTML = 'âœ… Completed!';
        triggerCelebration();
        
        // [EDIT 6] LOCAL STORAGE KEY: Change this key to match the lessonId above
        localStorage.setItem('lesson_unique-id_completed', 'true');
    }
}

// --- Celebration Effects ---

function triggerCelebration() {
    createConfetti();
    showSuccessMessage();
}

function createConfetti() {
    const confettiContainer = document.createElement('div');
    confettiContainer.className = 'confetti-container';
    document.body.appendChild(confettiContainer);
    
    const emojis = ['ðŸŽ§', 'ðŸŽµ', 'ðŸŽ™ï¸', 'âœ¨', 'ðŸŒŸ', 'ðŸ“¡'];
    const colors = ['#667eea', '#764ba2', '#4facfe', '#00f2fe'];
    
    for (let i = 0; i < 40; i++) {
        setTimeout(() => {
            const confetti = document.createElement('div');
            confetti.className = 'confetti';
            if (Math.random() > 0.5) {
                confetti.textContent = emojis[Math.floor(Math.random() * emojis.length)];
            } else {
                confetti.innerHTML = 'â—';
                confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
            }
            confetti.style.left = Math.random() * 100 + '%';
            confetti.style.animationDelay = Math.random() * 2 + 's';
            document.querySelector('.confetti-container').appendChild(confetti);
        }, i * 50);
    }
    
    setTimeout(() => { 
        if (confettiContainer.parentNode) confettiContainer.parentNode.removeChild(confettiContainer); 
    }, 5000);
}

function showSuccessMessage() {
    const successMessage = document.createElement('div');
    successMessage.className = 'success-message';
    successMessage.innerHTML = 'ðŸŽ‰ Podcast Completed! ðŸŽ‰';
    document.body.appendChild(successMessage);
    setTimeout(() => { 
        if (successMessage.parentNode) successMessage.parentNode.removeChild(successMessage); 
    }, 2500);
}

// --- Initialization ---

window.addEventListener('load', function() {
    const button = document.getElementById('markCompletedBtn');
    if (!button) return;

    // Check parent tracker (uses same IDs as above)
    if (window.parent && window.parent.ProgressTracker) {
        let courseId = 'computer-vision';
        let pathId = 'generative-adversarial-networks';
        let moduleId = 'module-id';
        let lessonId = 'unique-lesson-id'; // <--- Update this to match

        if (window.parent.currentRoute) {
            const route = window.parent.currentRoute;
            if (route.courseId) courseId = route.courseId;
            if (route.pathId) pathId = route.pathId;
            if (route.moduleId) moduleId = route.moduleId;
            if (route.lessonId) lessonId = route.lessonId;
        }

        try {
            const progress = window.parent.ProgressTracker.getLessonProgress(courseId, pathId, moduleId, lessonId);
            if (progress && progress.state === window.parent.ProgressTracker.STATES.COMPLETED) {
                button.classList.add('completed');
                button.innerHTML = 'âœ… Completed!';
                return;
            }
        } catch(e) { console.log("Tracker error", e); }
    }

    // Check local storage fallback
    // [EDIT 7] Update this key to match [EDIT 6]
    const isCompleted = localStorage.getItem('lesson_unique-id_completed') === 'true';
    if (isCompleted) {
        button.classList.add('completed');
        button.innerHTML = 'âœ… Completed!';
    }
});
</script>
</body>
</html>
